# vim: syntax=yaml:

version: '3.6'
services:

  app:
    image: 'opertusmundi/persistent-identifier-service:${VERSION}'
    build:
      context: .
    volumes:
    - type: bind
      source: ./secrets/
      target: /secrets/
      read_only: true
    - type: bind
      source: ./logging.conf
      target: /var/local/persistent-identifier-service/logging.conf
      read_only: true
    - type: bind
      source: ./logs/
      target: /var/local/persistent-identifier-service/logs/
    environment:
      DATABASE_URL: ${DATABASE_URL}
      DATABASE_USERNAME: ${DATABASE_USERNAME}
      DATABASE_PASSWORD_FILE: /secrets/database-password
      #RSYSLOG_HOST: rsyslog-1
    ports:
    - '8000:8000'
    networks:
      opertusmundi_network:
        aliases:
        - 'pid'

networks:
  opertusmundi_network: {external: true}

